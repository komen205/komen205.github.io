<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c1{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c2{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c3 doc-content"><div><p class="c1 c2"><span class="c0"></span></p></div><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 379.00px; height: 407.00px;"><img alt="" src="images/image1.png" style="width: 379.00px; height: 407.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">A good way to find out malware is to look through the ads, normally there are youtube ads with gambling applications but this time I found a backdoor. This is the first time I actually got a TP backdoor in ads.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">The usual signal of this application was that it was a PDF reader and had 1K installations.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">AndroidManifest had the permission REQUEST_INSTALL_PACKAGES, which is a signal that the application can install other applications. Used commonly by droppers.</span></p><p class="c1"><span class="c0">The next step was to find where the application was using this permission, so I used jadx-gui to decompile the application and search for the permission.</span></p><p class="c1"><span class="c0">I searched for package/vnd.android.package-archive but I couldn&#39;t find anything, so I searched for &quot;https://&quot; and found the following code:</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">Two C2&#39;s were hardcoded in the application in plain text with the same domain, they contained binaries that were downloaded and executed in the device.</span></p><p class="c1"><span class="c0">I won&#39;t go into detail how the payload was downloaded and executed, I found this while I was reversing another application and I wanted to provide a quick write-up about it.</span></p><p class="c1"><span class="c0">All C2&#39;s were saved in wayback machine.</span></p><p class="c1"><span class="c0">- https://dulinare[.]com/pdffile</span></p><p class="c1"><span class="c0">- https://dulinare[.]com/hanihani (malicious dex file)</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">Loading the dex file there were only 4 classes, I searched around them and could see an anti-emulator check and geo-location check.</span></p><p class="c1"><span class="c0">Seems to be targeting the following ISO&#39;s:</span></p><p class="c1"><span class="c0">- es, sk, si, sl, bg, gb, cn, fi, hu, ie, pt</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">Another C2 was found, this one had the actual backdoor:</span></p><p class="c1"><span class="c0">- https://sefuban[.]com/1.apk</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">Installing this last APK, quickly asked for accessibility permissions and started to send the following information to the C2:</span></p><p class="c1"><span class="c0">- http://185.215.113[.]31:85/api/getkeyloggers</span></p><p class="c1"><span class="c0">- http://185.215.113[.]31:85/api/botupdate</span></p><p class="c1"><span class="c0">- http://91.215.85[.]55:85/api</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">I haven&#39;t looked much into what the backdoor actually did, but the url /api/getkeyloggers is a good signal that it was a keylogger.</span></p><p class="c1"><span class="c0">Inside the C2, there were multiple banks and applications, so it was probably a banking trojan targeting also Portuguese people.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">For example, the following banks were targeted and much more:</span></p><p class="c1"><span class="c0">&nbsp;- com.binance.dev</span></p><p class="c1"><span class="c0">&nbsp;- pt.santander.oneappparticulares</span></p><p class="c1"><span class="c0">&nbsp;- com.revolut.business</span></p><p class="c1"><span class="c0">&nbsp;- id=com.santandermovelempresarial.app</span></p><p class="c1"><span class="c0">&nbsp;- de.traderepublic.app</span></p><p class="c1"><span class="c0">&nbsp;- ie.avantmoney.mobileapp</span></p><p class="c1"><span class="c0">&nbsp;- com.comtrade.simba.gbkr</span></p><p class="c1"><span class="c0">&nbsp;- dbs.mobileBankingProd</span></p><p class="c1"><span class="c0">&nbsp;- com.hrc.eb.mobile.android.hibismobilelon</span></p><p class="c1"><span class="c0">&nbsp;- com.hrc.eb.mobile.android.hibismobilevipava</span></p><p class="c1"><span class="c0">&nbsp;- bg.ccbmobile.app</span></p><p class="c1"><span class="c0">&nbsp;- bg.allianz.banking</span></p><p class="c1"><span class="c0">&nbsp;- com.openintegra.dsk_smart_business</span></p><p class="c1"><span class="c0">&nbsp;- sk.vub.banking</span></p><p class="c1"><span class="c0">&nbsp;- cgd.pt.caixadirectaparticulares</span></p><p class="c1"><span class="c0">&nbsp;- wit.android.bcpBankingApp.millennium</span></p><p class="c1"><span class="c0">&nbsp;- pt.novobanco.nbsmarter</span></p><p class="c1"><span class="c0">&nbsp;- wit.android.bcpBankingApp.activoBank</span></p><p class="c1"><span class="c0">&nbsp;- pt.bctt.appbctt</span></p><p class="c1"><span class="c0">&nbsp;- pt.cetelem.homebanking</span></p><p class="c1"><span class="c0">&nbsp;- pt.oney.oneyapp</span></p><p class="c1"><span class="c0">&nbsp;- com.bankinter.portugal.bmb</span></p><p class="c1"><span class="c0">&nbsp;- pt.sonaefs.Universo</span></p><p class="c1"><span class="c0">&nbsp;- app.wizink.pt</span></p><p class="c1"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"><img alt="" src="images/image2.png" style="width: 1000px; height: 500px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c1"><span class="c0">Encryption/decryption algorithm of the requests is XOR with the key 66 decimal.</span></p><p class="c1 c2"><span class="c0"></span></p><p class="c1"><span class="c0">SHA256 DIGESTS of the samples:</span></p><p class="c1"><span class="c0">- 95765ba9ade111c579d53d10585f594af6241f32599d084b4646316facc491aa</span></p><p class="c1"><span class="c0">- 6b49ff162980515a62a716c76b0c170f80dd01e5b533c2a458ddf88bc74eb49d</span></p><p class="c1"><span class="c0">&nbsp;</span></p></body></html>